# RAG_Word 项目深度分析文档

## 项目概述

RAG_Word 是一个基于检索增强生成（RAG）技术的智能文档问答系统，专门处理 Word 文档。系统结合向量数据库、嵌入模型、大语言模型等技术，实现文档智能理解和问答。

## 核心文件分析

### 1. main.py - 程序入口
**作用**: 系统主入口，提供使用示例
**功能**: 初始化RAG系统，读取文档，执行问答
**业务逻辑**: 创建RAG实例 → 读取文档目录 → 执行问答 → 输出结果

### 2. rag_faiss.py - FAISS向量数据库实现
**作用**: 使用FAISS实现文档检索和问答
**核心类**: RAG_Word_FAISS
**主要功能**:
- 文档加载和预处理
- 文本分块处理
- FAISS向量数据库构建
- 相似性检索
- 问答链构建

**业务逻辑流程**:
```
初始化 → 检查索引 → 构建/加载索引 → 设置检索器 → 执行问答
```

### 3. rag_note.py - 多Agent架构实现
**作用**: 实现基于多Agent协作的RAG系统
**核心Agent**:
- DocumentPreprocessingAgent: 文档预处理
- VectorStoreAgent: 向量存储管理
- QAAgent: 问答生成
- ReasoningAgent: 多轮推理
- GenerationAgent: 摘要生成
- TaskCoordinatorAgent: 任务协调

**业务逻辑**: Agent注册 → 任务分发 → 协作执行 → 结果聚合

### 4. parse_notes.py - Chroma向量数据库实现
**作用**: 使用Chroma实现另一种RAG方案
**核心类**: RAG_Word
**功能**: MistralAI模型集成，Chroma数据库管理，持久化存储

### 5. word_loader.py - Word文档加载器
**作用**: 专门加载和解析Word文档
**功能**: 使用python-docx解析文档，提取文本，构造文档对象

### 6. local_model/ - 本地嵌入模型
**作用**: 存储本地嵌入模型，避免依赖外部API
**模型**: all-MiniLM-L6-v2 (384维嵌入)
**文件**: 模型权重、词汇表、分词器配置等

## 完整业务逻辑流程

### 1. 系统初始化
```
加载环境变量 → 初始化模型组件 → 设置配置参数
```

### 2. 文档处理
```
文档发现 → 文档加载 → 文本预处理 → 文本分块
```

### 3. 向量化处理
```
嵌入生成 → 向量存储 → 元数据管理
```

### 4. 查询处理
```
查询预处理 → 向量检索 → 上下文构建
```

### 5. 答案生成
```
提示词构造 → 模型推理 → 答案后处理
```

## 技术特点

- **多模型支持**: OpenAI、MistralAI、本地模型
- **多向量数据库**: FAISS、Chroma
- **模块化设计**: 组件独立，易于替换
- **多Agent架构**: 支持复杂任务分解
- **错误处理**: 重试机制、异常处理、资源管理

## 性能优化

- 向量检索优化: FAISS高效索引、相似性阈值过滤
- 内存管理: 文档分块、向量压缩、资源释放
- 缓存策略: 索引持久化、查询结果缓存

## 扩展性设计

- 新模型集成: 标准化接口、配置化参数
- 新数据源支持: 可扩展加载器、标准化格式
- 新功能模块: Agent注册、任务协调、结果聚合

## 总结

RAG_Word是一个功能完整、架构清晰的智能文档问答系统，通过多Agent协作、多模型支持、多向量数据库等技术，实现了对Word文档的深度理解和智能问答。
